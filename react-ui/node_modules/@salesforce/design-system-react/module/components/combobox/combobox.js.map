{"version":3,"sources":["../../../.tmp-es/components/combobox/combobox.jsx"],"names":["React","PropTypes","assign","find","reject","isEqual","findIndex","isFunction","classNames","shortid","Button","Dialog","InnerInput","InputIcon","Menu","Label","Popover","SelectedListBox","FieldLevelHelpTooltip","KEYS","KeyBuffer","keyLetterMenuItemSelect","mapKeyEventCallbacks","menuItemSelectScroll","checkProps","COMBOBOX","componentDoc","IconSettingsContext","currentOpenDropdown","documentDefined","document","propTypes","assistiveText","shape","label","string","loadingMenuItems","optionSelectedInMenu","popoverLabel","removeSingleSelectedOption","removePill","selectedListboxLabel","className","oneOfType","array","object","classNameContainer","classNameMenu","classNameMenuSubHeader","events","onBlur","func","onChange","onClose","onFocus","onOpen","onRequestClose","onRequestOpen","onRequestRemoveSelectedOption","onSelect","onSubmit","errorText","fieldLevelHelpTooltip","node","hasInputSpinner","bool","hasMenuSpinner","hasStaticAlignment","id","input","labels","multipleOptionsSelected","noOptionsFound","placeholder","placeholderReadOnly","removePillTitle","isOpen","inheritWidthOf","oneOf","onRenderMenuItem","menuPosition","menuMaxWidth","multiple","options","arrayOf","isRequired","icon","subTitle","type","disabled","boolean","tooltipContent","menuItemVisibleLength","predefinedOptionsOnly","popover","required","selection","selectedListboxRef","singleInputDisabled","tooltipMenuItemDisabled","element","value","defaultValue","optionsAddItem","optionsSearchEntity","entityCombobox","variant","defaultProps","cancelButton","doneButton","optionDisabledTooltipLabel","Combobox","props","body","popoverBody","getId","popoverFooter","e","handleClose","trigger","defaultPopoverProps","ariaLabelledby","align","footer","footerClassName","hasNoNubbin","state","hasNoTriggerStyles","handleOpen","popoverProps","children","generatedId","activeOption","activeOptionIndex","offset","nextIndex","skipIndex","length","newIndex","hasNewIndex","localProps","push","inputRef","component","inputRendered","setState","ref","listboxHasFocus","event","handleRequestClose","getIsOpen","undefined","setTimeout","activeElement","tagName","focus","requestOpenMenu","target","onClick","getIsActiveOption","handleSelect","option","callbacks","DOWN","callback","handleKeyDownDown","ENTER","handleInputSubmit","ESCAPE","UP","handleKeyDownUp","TAB","handleKeyDownTab","other","handleKeyDownOther","stopPropagation","shiftKey","openDialog","handleNavigateListboxMenu","direction","key","keyBuffer","menuKeyBuffer","keyCode","getOptions","container","menuRef","focusedIndex","offsets","next","previous","prevState","getNewActiveOptionIndex","isLastOptionAndRightIsPressed","activeSelectedOptionIndex","isFirstOptionAndLeftIsPressed","newState","activeSelectedOption","data","item","index","preventDefault","onlyOnePillAndInputExists","isReadOnlyAndTwoPillsExists","lastPillWasRemoved","activeSelectedOptionRef","newSelection","isSelected","singleSelectAndSelectedWasNotClicked","multiSelectAndSelectedWasNotClicked","isInlineSingleSelectionAndIsNotSelected","userDefinedProps","getErrorId","role","inputIconTitle","handleInputFocus","handleInputBlur","handleKeyDown","setInputRef","handleInputChange","getDialog","menuRenderer","renderMenu","onBlurPill","handleBlurPill","onPillFocus","handlePillFocus","onRequestFocus","handleRequestFocusSelectedListbox","onRequestFocusOnNextPill","handleNavigateSelectedListbox","onRequestFocusOnPreviousPill","onRequestRemove","handleRemoveSelectedOption","setSelectedListboxRef","iconLeft","cloneElement","containerClassName","buttonRef","menuVariant","base","readonly","readonlyItemVisibleLength","clearActiveOption","menuItem","getCustomPopoverProps","generate","generatedErrorId","nextProps","selectedOptionsRenderIsInitialRender","isInline","context","getTargetElement","hasRenderedLabel","subRenderParameters","multipleOrSingle","subRenders","renderBase","single","renderInlineMultiple","renderInlineSingle","renderPopover","renderReadOnlyMultiple","renderReadOnlySingle","variantExists","mainCombobox","Component","contextType","displayName"],"mappings":"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","sourcesContent":["/* eslint-disable max-lines */\n/* Copyright (c) 2015-present, salesforce.com, inc. All rights reserved */\n/* Licensed under BSD 3-Clause - see LICENSE.txt or git.io/sfdc-license */\n\n/* eslint-disable max-lines */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport assign from 'lodash.assign';\nimport find from 'lodash.find';\nimport reject from 'lodash.reject';\nimport isEqual from 'lodash.isequal';\nimport findIndex from 'lodash.findindex';\nimport isFunction from 'lodash.isfunction';\n\nimport classNames from 'classnames';\n\nimport shortid from 'shortid';\n\nimport Button from '../button';\nimport Dialog from '../utilities/dialog';\nimport InnerInput from '../../components/input/private/inner-input';\nimport InputIcon from '../icon/input-icon';\nimport Menu from './private/menu';\nimport Label from '../forms/private/label';\nimport Popover from '../popover';\nimport SelectedListBox from '../pill-container/private/selected-listbox';\n\nimport FieldLevelHelpTooltip from '../tooltip/private/field-level-help-tooltip';\nimport KEYS from '../../utilities/key-code';\nimport KeyBuffer from '../../utilities/key-buffer';\nimport keyLetterMenuItemSelect from '../../utilities/key-letter-menu-item-select';\nimport mapKeyEventCallbacks from '../../utilities/key-callbacks';\nimport menuItemSelectScroll from '../../utilities/menu-item-select-scroll';\n\nimport checkProps from './check-props';\n\nimport { COMBOBOX } from '../../utilities/constants';\nimport componentDoc from './component.json';\nimport { IconSettingsContext } from '../icon-settings';\n\nlet currentOpenDropdown;\nconst documentDefined = typeof document !== 'undefined';\n\nconst propTypes = {\n\t/**\n\t * **Assistive text for accessibility**\n\t * This object is merged with the default props object on every render.\n\t * * `label`: This is used as a visually hidden label if, no `labels.label` is provided.\n\t * * `loading`: Text added to loading spinner.\n\t * * `optionSelectedInMenu`: Added before selected menu items in Read-only variants (Picklists). The default is `Current Selection:`.\n\t * * `popoverLabel`: Used by popover variant, assistive text for the Popover aria-label.\n\t * * `removeSingleSelectedOption`: Used by inline-listbox, single-select variant to remove the selected item (pill). This is a button with focus. The default is `Remove selected option`.\n\t * * `removePill`: Used by multiple selection Comboboxes to remove a selected item (pill). Focus is on the pill. This is not a button. The default  is `, Press delete or backspace to remove`.\n\t * * `selectedListboxLabel`: This is a label for the selected listbox. The grouping of pills for multiple selection Comboboxes. The default is `Selected Options:`.\n\t * _Tested with snapshot testing._\n\t */\n\tassistiveText: PropTypes.shape({\n\t\tlabel: PropTypes.string,\n\t\tloadingMenuItems: PropTypes.string,\n\t\toptionSelectedInMenu: PropTypes.string,\n\t\tpopoverLabel: PropTypes.string,\n\t\tremoveSingleSelectedOption: PropTypes.string,\n\t\tremovePill: PropTypes.string,\n\t\tselectedListboxLabel: PropTypes.string,\n\t}),\n\t/**\n\t * The `aria-describedby` attribute is used to indicate the IDs of the elements that describe the object. It is used to establish a relationship between widgets or groups and text that described them.\n\t * This is very similar to aria-labelledby: a label describes the essence of an object, while a description provides more information that the user might need. _Tested with snapshot testing._\n\t */\n\t'aria-describedby': PropTypes.string,\n\t/**\n\t * CSS classes to be added to tag with `.slds-combobox`. Uses `classNames` [API](https://github.com/JedWatson/classnames). _Tested with snapshot testing._\n\t */\n\tclassName: PropTypes.oneOfType([\n\t\tPropTypes.array,\n\t\tPropTypes.object,\n\t\tPropTypes.string,\n\t]),\n\t/**\n\t * CSS classes to be added to top level tag with `.slds-form-element` and not on `.slds-combobox_container`. Uses `classNames` [API](https://github.com/JedWatson/classnames). _Tested with snapshot testing._\n\t */\n\tclassNameContainer: PropTypes.oneOfType([\n\t\tPropTypes.array,\n\t\tPropTypes.object,\n\t\tPropTypes.string,\n\t]),\n\t/**\n\t * CSS classes to be added to tag with `.slds-dropdown`. Uses `classNames` [API](https://github.com/JedWatson/classnames). Autocomplete/bass variant menu height should not scroll and should be determined by number items which should be no more than 10. _Tested with snapshot testing._\n\t */\n\tclassNameMenu: PropTypes.oneOfType([\n\t\tPropTypes.array,\n\t\tPropTypes.object,\n\t\tPropTypes.string,\n\t]),\n\t/**\n\t * CSS classes to be added to tag with `.slds-dropdown__header`. Uses `classNames` [API](https://github.com/JedWatson/classnames).\n\t */\n\tclassNameMenuSubHeader: PropTypes.oneOfType([\n\t\tPropTypes.array,\n\t\tPropTypes.object,\n\t\tPropTypes.string,\n\t]),\n\t/**\n\t * Event Callbacks\n\t * * `onBlur`: Called when `input` removes focus.\n\t * * `onChange`: Called when keyboard events occur within `input`\n\t * * `onClose`: Triggered when the menu has closed.\n\t * * `onFocus`: Called when `input` receives focus.\n\t * * `onOpen`: Triggered when the menu has opened.\n\t * * `onRequestClose`: Function called when the menu would like to hide. Please use with `isOpen`.\n\t * * `onRequestOpen`:  Function called when the menu would like to show. Please use with `isOpen`.\n\t * * `onRequestRemoveSelectedOption`: Function called when a single selection option is to be removed.\n\t * * `onSelect`: Function called when a menu item is selected. This includes header and footer items.\n\t * * `onSubmit`: Function called when user presses enter or submits the `input`\n\t * _Tested with Mocha testing._\n\t */\n\tevents: PropTypes.shape({\n\t\tonBlur: PropTypes.func,\n\t\tonChange: PropTypes.func,\n\t\tonClose: PropTypes.func,\n\t\tonFocus: PropTypes.func,\n\t\tonOpen: PropTypes.func,\n\t\tonRequestClose: PropTypes.func,\n\t\tonRequestOpen: PropTypes.func,\n\t\tonRequestRemoveSelectedOption: PropTypes.func,\n\t\tonSelect: PropTypes.func,\n\t\tonSubmit: PropTypes.func,\n\t}),\n\t/**\n\t * Message to display when the input is in an error state. When this is present, also visually highlights the component as in error. _Tested with snapshot testing._\n\t */\n\terrorText: PropTypes.string,\n\t/**\n\t * A [Tooltip](https://react.lightningdesignsystem.com/components/tooltips/) component that is displayed next to the `labels.label`. The props from the component will be merged and override any default props.\n\t */\n\tfieldLevelHelpTooltip: PropTypes.node,\n\t/**\n\t * If true, loading spinner appears inside input on right hand side.\n\t */\n\thasInputSpinner: PropTypes.bool,\n\t/**\n\t * Add loading spinner below the options\n\t */\n\thasMenuSpinner: PropTypes.bool,\n\t/**\n\t * By default, dialogs will flip their alignment (such as bottom to top) if they extend beyond a boundary element such as a scrolling parent or a window/viewpoint. `hasStaticAlignment` disables this behavior and allows this component to extend beyond boundary elements. _Not tested._\n\t */\n\thasStaticAlignment: PropTypes.bool,\n\t/**\n\t * HTML id for component. _Tested with snapshot testing._\n\t */\n\tid: PropTypes.string,\n\t/**\n\t * An [Input](https://react.lightningdesignsystem.com/components/inputs) component.\n\t * The props from this component will override any default props.\n\t */\n\tinput: PropTypes.node,\n\t/**\n\t * **Text labels for internationalization**\n\t * This object is merged with the default props object on every render.\n\t * * `label`: This label appears above the input.\n\t * * `cancelButton`: This label is only used by the dialog variant for the cancel button in the footer of the dialog. The default is `Cancel`\n\t * * `doneButton`: This label is only used by the dialog variant for the done button in the footer of the dialog. The default is `Done`\n\t * * `multipleOptionsSelected`: This label is used by the readonly variant when multiple options are selected. The default is `${props.selection.length} options selected`. This will override the entire string.\n\t * * `noOptionsFound`: Custom message that renders when no matches found. The default empty state is just text that says, 'No matches found.'.\n\t * * `placeholder`: Input placeholder\n\t * * `placeholderReadOnly`: Placeholder for Picklist-like Combobox\n\t * * `removePillTitle`: Title on `X` icon\n\t * _Tested with snapshot testing._\n\t */\n\tlabels: PropTypes.shape({\n\t\tlabel: PropTypes.oneOfType([PropTypes.node, PropTypes.string]),\n\t\tmultipleOptionsSelected: PropTypes.string,\n\t\tnoOptionsFound: PropTypes.oneOfType([PropTypes.node, PropTypes.string]),\n\t\tplaceholder: PropTypes.string,\n\t\tplaceholderReadOnly: PropTypes.string,\n\t\tremovePillTitle: PropTypes.string,\n\t}),\n\t/**\n\t * Forces the dropdown to be open or closed. See controlled/uncontrolled callback/prop pattern for more on suggested use view [Concepts and Best Practices](https://github.com/salesforce-ux/design-system-react/blob/master/CONTRIBUTING.md#concepts-and-best-practices) _Tested with snapshot testing._\n\t */\n\tisOpen: PropTypes.bool,\n\t/**\n\t * Sets the dialog width to the width of one of the following:\n\t * * `target`: Sets the dialog width to the width of the target. (Menus attached to `input` typically follow this UX pattern),\n\t * * `menu`: Consider setting a `menuMaxWidth` if using this value. If not, width will be set to width of largest menu item.\n\t * * `none`: Does not set a width on the dialog. _Tested with snapshot testing._\n\t */\n\tinheritWidthOf: PropTypes.oneOf(['target', 'menu', 'none']),\n\t/**\n\t * Accepts a custom menu item rendering function that becomes a custom component. It should return a React node. The checkmark is still rendered in readonly variants. This function is passed the following props:\n\t * * `assistiveText`: Object, `assistiveText` prop that is passed into Combobox\n\t * * `option`: Object, option data for item being rendered that is passed into Combobox\n\t * * `selected`: Boolean, allows rendering of `assistiveText.optionSelectedInMenu` in Readonly Combobox\n\t *\n\t * _Tested with snapshot testing._\n\t */\n\tonRenderMenuItem: PropTypes.func,\n\t/**\n\t * Please select one of the following:\n\t * * `absolute` - (default) The dialog will use `position: absolute` and style attributes to position itself. This allows inverted placement or flipping of the dialog.\n\t * * `overflowBoundaryElement` - The dialog will overflow scrolling parents. Use on elements that are aligned to the left or right of their target and don't care about the target being within a scrolling parent. Typically this is a popover or tooltip. Dropdown menus can usually open up and down if no room exists. In order to achieve this a portal element will be created and attached to `body`. This element will render into that detached render tree.\n\t * * `relative` - No styling or portals will be used. Menus will be positioned relative to their triggers. This is a great choice for HTML snapshot testing.\n\t */\n\tmenuPosition: PropTypes.oneOf([\n\t\t'absolute',\n\t\t'overflowBoundaryElement',\n\t\t'relative',\n\t]),\n\t/**\n\t * Sets a maximum width that the menu will be used if `inheritWidthOf` is set to `menu`. (Example: 500px) _Tested with snapshot testing._\n\t *\n\t */\n\tmenuMaxWidth: PropTypes.string,\n\t/**\n\t * Allows multiple selections _Tested with mocha testing._\n\t */\n\tmultiple: PropTypes.bool,\n\t/**\n\t * **Array of item objects in the dropdown menu.**\n\t * Each object can contain:\n\t * * `icon`: An `Icon` component. (not used in read-only variant)\n\t * * `id`: A unique identifier string.\n\t * * `label`: A primary string of text for a menu item or group separator.\n\t * * `subTitle`: A secondary string of text added for clarity. (optional)\n\t * * `type`: 'separator' is the only type currently used\n\t * * `disabled`: Set to true to disable this menu item.\n\t * * `tooltipContent`: Content that is displayed in tooltip when item is disabled\n\t * ```\n\t * {\n\t * \tid: '2',\n\t * \tlabel: 'Salesforce.com, Inc.',\n\t * \tsubTitle: 'Account  San Francisco',\n\t * \ttype: 'account',\n\t *  disabled: true,\n\t *  tooltipContent: \"You don't have permission to select this item.\"\n\t * },\n\t * ```\n\t * Note: At the moment, Combobox does not support two consecutive separators. _Tested with snapshot testing._\n\t */\n\toptions: PropTypes.arrayOf(\n\t\tPropTypes.PropTypes.shape({\n\t\t\tid: PropTypes.string.isRequired,\n\t\t\ticon: PropTypes.node,\n\t\t\tlabel: PropTypes.string,\n\t\t\tsubTitle: PropTypes.string,\n\t\t\ttype: PropTypes.string,\n\t\t\tdisabled: PropTypes.boolean,\n\t\t\ttooltipContent: PropTypes.node,\n\t\t})\n\t),\n\t/**\n\t * Determines the height of the menu based on SLDS CSS classes. This is a `number`. The default for a `readonly` variant is `5`.\n\t */\n\tmenuItemVisibleLength: PropTypes.oneOf([5, 7, 10]),\n\t/**\n\t * Limits auto-complete input submission to one of the provided options. _Tested with mocha testing._\n\t */\n\tpredefinedOptionsOnly: PropTypes.bool,\n\t/**\n\t * A `Popover` component. The props from this popover will be merged and override any default props. This also allows a Combobox's Popover dialog to be a controlled component. _Tested with snapshot testing._\n\t */\n\tpopover: PropTypes.node,\n\t/**\n\t * Applies label styling for a required form element. _Tested with snapshot testing._\n\t */\n\trequired: PropTypes.bool,\n\t/**\n\t * Accepts an array of item objects. For single selection, pass in an array of one object. For item object keys, see `options` prop. _Tested with snapshot testing._\n\t */\n\tselection: PropTypes.arrayOf(\n\t\tPropTypes.PropTypes.shape({\n\t\t\tid: PropTypes.string.isRequired,\n\t\t\ticon: PropTypes.node,\n\t\t\tlabel: PropTypes.string,\n\t\t\tsubTitle: PropTypes.string,\n\t\t\ttype: PropTypes.string,\n\t\t})\n\t).isRequired,\n\t/**\n\t * This callback exposes the selected listbox reference / DOM node to parent components.\n\t */\n\tselectedListboxRef: PropTypes.func,\n\t/**\n\t * Disables the input and prevents editing the contents. This only applies for single readonly and inline-listbox variants.\n\t */\n\tsingleInputDisabled: PropTypes.bool,\n\t/**\n\t * Accepts a tooltip that is displayed when hovering on disabled menu items.\n\t */\n\ttooltipMenuItemDisabled: PropTypes.element,\n\t/**\n\t * Value of input. _This is a controlled component,_ so you will need to control the input value by passing the `value` from `onChange` to a parent component or state manager, and then pass it back into the componet with this prop. Please see examples for more clarification. _Tested with snapshot testing._\n\t */\n\tvalue: PropTypes.string,\n\t/**\n\t * Changes styles of the input and menu. Currently `entity` is not supported.\n\t * The options are:\n\t * * `base`: An autocomplete Combobox also allows a user to select an option from a list, but that list can be affected by what the user types into the input of the Combobox. The SLDS website used to call the autocomplete Combobox its `base` variant.\n\t * * `inline-listbox`: An Entity Autocomplete Combobox or Lookup, is used to search for and select Salesforce Entities.\n\t * * `popover`: A dialog Combobox is best used when a listbox, tree, grid, or tree-grid is not the best solution. This variant allows custom content.\n\t * * `readonly`: A readonly text input that allows a user to select an option from a pre-defined list of options. It does not allow free form user input, nor does it allow the user to modify the selected value.\n\t *\n\t *  _Tested with snapshot testing._\n\t */\n\t/**\n\t * Default value of input. Provide uncontroled behaviour\n\t */\n\tdefaultValue: PropTypes.string,\n\t/**\n\t * **Array of item objects in the dropdown menu that is displayed below the list of `options`. `onSelect` fires when selected.**\n\t * Each object can contain:\n\t * * `id`: A unique identifier string.\n\t * * `icon`: An [Icon](/components/icons/) component to be displayed to the left of the menu item `label`.\n\t * * `label`: A primary string of text for a menu item or a function that receives `inputValue` as function parameter and returns text to be displayed in for a menu item.\n\t * ```\n\t * {\n\t * \tid: '1',\n\t * \ticon: (\n\t *  \t<Icon\n\t * \t\t\tassistiveText={{ label: 'add' }}\n\t * \t\t\tcategory=\"utility\"\n\t * \t\t\tsize=\"x-small\"\n\t * \t\t\tname=\"add\"\n\t * \t\t/>\n\t * \t),\n\t * \tlabel: 'New Entity'\n\t * }\n\t * ```\n\t * _Tested with snapshot testing._\n\t */\n\toptionsAddItem: PropTypes.arrayOf(\n\t\tPropTypes.shape({\n\t\t\tid: PropTypes.string,\n\t\t\ticon: PropTypes.node,\n\t\t\tlabel: PropTypes.oneOfType([PropTypes.string, PropTypes.func]),\n\t\t})\n\t),\n\t/**\n\t * **Array of item objects in the dropdown menu that is displayed above the list of `options`. `onSelect` fires when selected. **\n\t * Each object can contain:\n\t * * `id`: A unique identifier string.\n\t * * `icon`: An [Icon](/components/icons/) component to be displayed to the left of the menu item `label`.\n\t * * `label`: A primary string of text for a menu item or a function that receives `inputValue` as function parameter and returns text to be displayed in for a menu item.\n\t * ```\n\t * {\n\t *\tid: '1',\n\t *\ticon: (\n\t *\t\t<Icon\n\t *\t\t\tassistiveText={{ label: 'Add in Accounts' }}\n\t *\t\t\tsize=\"x-small\"\n\t *\t\t\tcategory=\"utility\"\n\t *\t\t\tname=\"search\"\n\t *\t\t/>\n\t *\t),\n\t *\tlabel: (searchTerm) => {\n\t *\t\treturn `${searchTerm} in Accounts`;\n\t *\t},\n\t * }\n\t * ```\n\t * _Tested with snapshot testing._\n\t */\n\toptionsSearchEntity: PropTypes.arrayOf(\n\t\tPropTypes.shape({\n\t\t\tid: PropTypes.string,\n\t\t\ticon: PropTypes.node,\n\t\t\tlabel: PropTypes.oneOfType([PropTypes.string, PropTypes.func]),\n\t\t})\n\t),\n\t/**\n\t * Node of type [Combobox](/components/comboboxes/) for creating grouped comboboxes.\n\t */\n\tentityCombobox: PropTypes.node,\n\t/**\n\t * Defines Combobox variant styling and functionality\n\t */\n\tvariant: PropTypes.oneOf(['base', 'inline-listbox', 'popover', 'readonly']),\n};\n\nconst defaultProps = {\n\tassistiveText: {\n\t\tloadingMenuItems: 'Loading',\n\t\toptionSelectedInMenu: 'Current Selection:',\n\t\tremoveSingleSelectedOption: 'Remove selected option',\n\t\tremovePill: ', Press delete or backspace to remove',\n\t\tselectedListboxLabel: 'Selected Options:',\n\t},\n\tevents: {},\n\tlabels: {\n\t\tcancelButton: 'Cancel',\n\t\tdoneButton: `Done`,\n\t\tnoOptionsFound: 'No matches found.',\n\t\toptionDisabledTooltipLabel: 'This option is disabled.',\n\t\tplaceholderReadOnly: 'Select an Option',\n\t\tremovePillTitle: 'Remove',\n\t},\n\tinheritWidthOf: 'target',\n\tmenuPosition: 'absolute',\n\toptionsSearchEntity: [],\n\toptionsAddItem: [],\n\trequired: false,\n\tselection: [],\n\tsingleInputDisabled: false,\n\tvariant: 'base',\n};\n\n/**\n * A widget that provides a user with an input field that is either an autocomplete or readonly, accompanied with a listbox of pre-definfined options.\n */\nclass Combobox extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\tactiveOption: undefined,\n\t\t\tactiveOptionIndex: -1,\n\t\t\t// seeding initial state with this.props.selection[0]\n\t\t\tactiveSelectedOption:\n\t\t\t\t(this.props.selection && this.props.selection[0]) || undefined,\n\t\t\tactiveSelectedOptionIndex: 0,\n\t\t\tlistboxHasFocus: false,\n\t\t\tisOpen: typeof props.isOpen === 'boolean' ? props.isOpen : false,\n\t\t};\n\n\t\tthis.menuKeyBuffer = new KeyBuffer();\n\t\tthis.menuRef = undefined;\n\t\tthis.selectedListboxRef = null;\n\n\t\t// `checkProps` issues warnings to developers about properties (similar to React's built in development tools)\n\t\tcheckProps(COMBOBOX, props, componentDoc);\n\n\t\tthis.generatedId = shortid.generate();\n\t\tthis.generatedErrorId = shortid.generate();\n\t}\n\n\t/**\n\t * Lifecycle methods\n\t */\n\n\tcomponentDidUpdate(nextProps) {\n\t\t// This logic will maintain the active highlight even when the\n\t\t// option order changes. One example would be the server pushes\n\t\t// data out as the user has the menu open. This logic clears\n\t\t// `activeOption` if the active option is no longer in the options\n\t\t// list. If it's in the options list, then find the new index and\n\t\t// set `activeOptionIndex`\n\t\tif (!isEqual(this.getOptions(), this.getOptions(nextProps))) {\n\t\t\tconst index = findIndex(this.getOptions(nextProps), (item) =>\n\t\t\t\tisEqual(item, this.state.activeOption)\n\t\t\t);\n\t\t\tif (index !== -1) {\n\t\t\t\t// eslint-disable-next-line react/no-did-update-set-state\n\t\t\t\tthis.setState({ activeOptionIndex: index });\n\t\t\t} else {\n\t\t\t\t// eslint-disable-next-line react/no-did-update-set-state\n\t\t\t\tthis.setState({ activeOption: undefined, activeOptionIndex: -1 });\n\t\t\t}\n\t\t} else if (this.props.isOpen !== nextProps.isOpen) {\n\t\t\t// eslint-disable-next-line react/no-did-update-set-state\n\t\t\tthis.setState({\n\t\t\t\tactiveOption: undefined,\n\t\t\t\tactiveOptionIndex: -1,\n\t\t\t\tisOpen: nextProps.isOpen,\n\t\t\t});\n\t\t}\n\n\t\t// there may be issues with tabindex/focus if the app removes an item\n\t\t// from selection while the user is using the listbox\n\t\tconst selectedOptionsRenderIsInitialRender =\n\t\t\tthis.props.selection &&\n\t\t\tthis.props.selection.length === 0 &&\n\t\t\tnextProps.selection.length > 0;\n\t\tif (selectedOptionsRenderIsInitialRender) {\n\t\t\t// eslint-disable-next-line react/no-did-update-set-state\n\t\t\tthis.setState({\n\t\t\t\tactiveSelectedOption: nextProps.selection[0],\n\t\t\t\tactiveSelectedOptionIndex: 0,\n\t\t\t});\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tif (currentOpenDropdown === this) {\n\t\t\tcurrentOpenDropdown = undefined;\n\t\t}\n\t}\n\n\tgetCustomPopoverProps = (body, { assistiveText, labels }) => {\n\t\t/*\n\t\t * Generate the popover props based on passed in popover props. Using the default behavior if not provided by passed in popover\n\t\t */\n\t\tconst popoverBody = (\n\t\t\t<div>\n\t\t\t\t<div className=\"slds-assistive-text\" id={`${this.getId()}-label`}>\n\t\t\t\t\t{assistiveText.popoverLabel}\n\t\t\t\t</div>\n\t\t\t\t{body}\n\t\t\t</div>\n\t\t);\n\n\t\tconst popoverFooter = (\n\t\t\t<div>\n\t\t\t\t<Button\n\t\t\t\t\tlabel={labels.cancelButton}\n\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\tthis.handleClose(e, { trigger: 'cancel' });\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t\t<Button\n\t\t\t\t\tlabel={labels.doneButton}\n\t\t\t\t\tvariant=\"brand\"\n\t\t\t\t\tonClick={this.handleClose}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\n\t\tconst defaultPopoverProps = {\n\t\t\tariaLabelledby: `${this.getId()}-label`,\n\t\t\talign: 'bottom',\n\t\t\tbody: popoverBody,\n\t\t\tclassName: 'slds-popover_full-width',\n\t\t\tfooter: popoverFooter,\n\t\t\tfooterClassName: 'slds-popover__footer_form',\n\t\t\thasNoNubbin: true,\n\t\t\tid: this.getId(),\n\t\t\tisOpen: this.state.isOpen,\n\t\t\thasNoTriggerStyles: true,\n\t\t\tonOpen: this.handleOpen,\n\t\t\tonClose: this.handleClose,\n\t\t\tonRequestClose: this.handleClose,\n\t\t};\n\n\t\t/* Merge in passed popover's props if there is any to override the default popover props */\n\t\tconst popoverProps = assign(\n\t\t\tdefaultPopoverProps,\n\t\t\tthis.props.popover ? this.props.popover.props : {}\n\t\t);\n\t\tpopoverProps.body = popoverBody;\n\n\t\t// eslint-disable-next-line fp/no-delete\n\t\tdelete popoverProps.children;\n\t\treturn popoverProps;\n\t};\n\n\tgetDialog({ menuRenderer }) {\n\t\t// FOR BACKWARDS COMPATIBILITY\n\t\tconst menuPosition = this.props.isInline\n\t\t\t? 'relative'\n\t\t\t: this.props.menuPosition; // eslint-disable-line react/prop-types\n\n\t\treturn !this.props.disabled && this.getIsOpen() ? (\n\t\t\t<Dialog\n\t\t\t\talign=\"bottom left\"\n\t\t\t\tcontext={this.context}\n\t\t\t\thasStaticAlignment={this.props.hasStaticAlignment}\n\t\t\t\tinheritWidthOf={this.props.inheritWidthOf}\n\t\t\t\tonClose={this.handleClose}\n\t\t\t\tonMouseDown={(event) => {\n\t\t\t\t\t// prevent onBlur\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}}\n\t\t\t\tonOpen={this.handleOpen}\n\t\t\t\tonRequestTargetElement={this.getTargetElement}\n\t\t\t\tposition={menuPosition}\n\t\t\t\tcontainerProps={{\n\t\t\t\t\tid: `${this.getId()}-listbox`,\n\t\t\t\t\trole: 'listbox',\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{menuRenderer}\n\t\t\t</Dialog>\n\t\t) : null;\n\t}\n\n\tgetErrorId() {\n\t\treturn (\n\t\t\tthis.props['aria-describedby'] ||\n\t\t\t(this.props.errorText && this.generatedErrorId)\n\t\t);\n\t}\n\n\t/**\n\t * Shared class property getter methods\n\t */\n\n\tgetId = () => this.props.id || this.generatedId;\n\n\tgetIsActiveOption = () =>\n\t\tthis.state.activeOption && this.state.activeOptionIndex !== -1;\n\n\tgetIsOpen = () =>\n\t\t!!(typeof this.props.isOpen === 'boolean'\n\t\t\t? this.props.isOpen\n\t\t\t: this.state.isOpen);\n\n\tgetNewActiveOptionIndex = ({ activeOptionIndex, offset, options }) => {\n\t\t// used by menu listbox and selected options listbox\n\t\tconst nextIndex = activeOptionIndex + offset;\n\t\tconst skipIndex =\n\t\t\toptions.length > nextIndex &&\n\t\t\tnextIndex >= 0 &&\n\t\t\toptions[nextIndex].type === 'separator';\n\t\tconst newIndex = skipIndex ? nextIndex + offset : nextIndex;\n\t\tconst hasNewIndex = options.length > nextIndex && nextIndex >= 0;\n\t\treturn hasNewIndex ? newIndex : activeOptionIndex;\n\t};\n\n\tgetOptions = (props = this.props) => {\n\t\tconst localProps = props;\n\t\tconst options = [];\n\t\tif (localProps.optionsSearchEntity.length > 0) {\n\t\t\t// eslint-disable-next-line fp/no-mutating-methods\n\t\t\toptions.push(...localProps.optionsSearchEntity);\n\t\t}\n\n\t\tif (localProps.options) {\n\t\t\t// eslint-disable-next-line fp/no-mutating-methods\n\t\t\toptions.push(...localProps.options);\n\t\t}\n\t\tif (localProps.optionsAddItem.length > 0) {\n\t\t\t// eslint-disable-next-line fp/no-mutating-methods\n\t\t\toptions.push(...localProps.optionsAddItem);\n\t\t}\n\t\treturn options;\n\t};\n\n\tgetTargetElement = () => this.inputRef;\n\n\tsetInputRef = (component) => {\n\t\tthis.inputRef = component;\n\t\t// yes, this is a render triggered by a render.\n\t\t// Dialog/Popper.js cannot place the menu until\n\t\t// the trigger/target DOM node is mounted. This\n\t\t// way `findDOMNode` is not called and parent\n\t\t// DOM nodes are not queried.\n\t\tif (!this.state.inputRendered) {\n\t\t\tthis.setState({ inputRendered: true });\n\t\t}\n\t};\n\n\tsetSelectedListboxRef = (ref) => {\n\t\tthis.selectedListboxRef = ref;\n\t\tif (this.props.selectedListboxRef) {\n\t\t\tthis.props.selectedListboxRef(ref);\n\t\t}\n\t};\n\n\thandleBlurPill = () => {\n\t\tthis.setState({ listboxHasFocus: false });\n\t};\n\n\t/**\n\t * Menu open/close and sub-render methods\n\t */\n\thandleClickOutside = (event) => {\n\t\tthis.handleRequestClose(event, {});\n\t};\n\n\thandleClose = (event, { trigger } = {}) => {\n\t\tconst isOpen = this.getIsOpen();\n\n\t\tif (isOpen) {\n\t\t\tif (currentOpenDropdown === this) {\n\t\t\t\tcurrentOpenDropdown = undefined;\n\t\t\t}\n\n\t\t\tthis.setState({\n\t\t\t\tactiveOption: undefined,\n\t\t\t\tactiveOptionIndex: -1,\n\t\t\t\tisOpen: false,\n\t\t\t});\n\n\t\t\tif (this.props.variant === 'popover' && trigger === 'cancel') {\n\t\t\t\tif (this.props.popover.props.onClose) {\n\t\t\t\t\tthis.props.popover.props.onClose(event, { trigger });\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.props.events.onClose) {\n\t\t\t\tthis.props.events.onClose(event, {});\n\t\t\t}\n\t\t}\n\t};\n\n\thandleInputBlur = (event) => {\n\t\t// If menu is open when the input's onBlur event fires, it will close before the onClick of the menu item can fire.\n\t\tsetTimeout(() => {\n\t\t\tconst activeElement = documentDefined ? document.activeElement : false;\n\t\t\t// detect if the scrollbar of the combobox-autocomplete/lookup menu is clicked in IE11. If it is, return focus to input, and do not close menu.\n\t\t\tif (\n\t\t\t\tactiveElement &&\n\t\t\t\tactiveElement.tagName === 'DIV' &&\n\t\t\t\tactiveElement.id === `${this.getId()}-listbox`\n\t\t\t) {\n\t\t\t\tif (this.inputRef) {\n\t\t\t\t\tthis.inputRef.focus();\n\t\t\t\t}\n\t\t\t} else if (!this.props.popover) {\n\t\t\t\tthis.handleClose(event);\n\t\t\t}\n\t\t}, 200);\n\n\t\tif (this.props.events.onBlur) {\n\t\t\tthis.props.events.onBlur(event);\n\t\t}\n\t};\n\n\thandleInputChange = (event) => {\n\t\tthis.requestOpenMenu();\n\t\tif (this.props.events && this.props.events.onChange) {\n\t\t\tthis.props.events.onChange(event, { value: event.target.value });\n\t\t}\n\t};\n\n\thandleInputFocus = (event) => {\n\t\tif (this.props.events.onFocus) {\n\t\t\tthis.props.events.onFocus(event, {});\n\t\t}\n\t};\n\n\thandleInputSubmit = (event) => {\n\t\tif (this.state.activeOption && this.state.activeOption.disabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tthis.state.activeOption &&\n\t\t\t(this.state.activeOption.type === 'header' ||\n\t\t\t\tthis.state.activeOption.type === 'footer')\n\t\t) {\n\t\t\tthis.state.activeOption.onClick(event);\n\t\t\treturn;\n\t\t}\n\n\t\t// use menu options\n\t\tif (this.getIsActiveOption()) {\n\t\t\tthis.handleSelect(event, {\n\t\t\t\toption: this.state.activeOption,\n\t\t\t\tselection: this.props.selection,\n\t\t\t});\n\t\t\t// use input value, if not limited to predefined options (in the menu)\n\t\t} else if (\n\t\t\t!this.props.predefinedOptionsOnly &&\n\t\t\tevent.target.value !== '' &&\n\t\t\tthis.props.events.onSubmit\n\t\t) {\n\t\t\tthis.props.events.onSubmit(event, {\n\t\t\t\tvalue: event.target.value,\n\t\t\t});\n\t\t}\n\t};\n\n\t/**\n\t * Input and menu keyboard event methods\n\t */\n\n\thandleKeyDown = (event) => {\n\t\tconst callbacks = {\n\t\t\t[KEYS.DOWN]: { callback: this.handleKeyDownDown },\n\t\t\t[KEYS.ENTER]: { callback: this.handleInputSubmit },\n\t\t\t[KEYS.ESCAPE]: { callback: this.handleClose },\n\t\t\t[KEYS.UP]: { callback: this.handleKeyDownUp },\n\t\t};\n\n\t\tif (this.props.variant === 'readonly') {\n\t\t\tif (this.props.selection.length > 2) {\n\t\t\t\tcallbacks[KEYS.TAB] = { callback: this.handleKeyDownTab };\n\t\t\t} else {\n\t\t\t\tcallbacks[KEYS.TAB] = undefined;\n\t\t\t}\n\t\t\tcallbacks.other = {\n\t\t\t\tcallback: this.handleKeyDownOther,\n\t\t\t\tstopPropagation: false,\n\t\t\t};\n\t\t}\n\n\t\t// Helper function that takes an object literal of callbacks that are triggered with a key event\n\t\tmapKeyEventCallbacks(event, { callbacks });\n\t};\n\n\thandleKeyDownDown = (event) => {\n\t\t// Don't open if user is selecting text\n\t\tif (!event.shiftKey) {\n\t\t\tthis.openDialog();\n\t\t}\n\n\t\tif (this.props.variant !== 'popover') {\n\t\t\tthis.handleNavigateListboxMenu(event, { direction: 'next' });\n\t\t}\n\t};\n\n\thandleKeyDownTab = () => {\n\t\tif (this.selectedListboxRef) {\n\t\t\tthis.setState({\n\t\t\t\tlistboxHasFocus: true,\n\t\t\t});\n\t\t}\n\t};\n\n\thandleKeyDownUp = (event) => {\n\t\t// Don't open if user is selecting text\n\t\tif (!event.shiftKey && this.getIsOpen()) {\n\t\t\tthis.handleNavigateListboxMenu(event, { direction: 'previous' });\n\t\t}\n\t};\n\n\thandleKeyDownOther = (event) => {\n\t\tconst activeOptionIndex = keyLetterMenuItemSelect({\n\t\t\tkey: event.key,\n\t\t\tkeyBuffer: this.menuKeyBuffer,\n\t\t\tkeyCode: event.keyCode,\n\t\t\toptions: this.getOptions(),\n\t\t});\n\n\t\tif (activeOptionIndex !== undefined) {\n\t\t\tif (this.getIsOpen()) {\n\t\t\t\tmenuItemSelectScroll({\n\t\t\t\t\tcontainer: this.menuRef,\n\t\t\t\t\tfocusedIndex: activeOptionIndex,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.setState({\n\t\t\t\tactiveOption: this.getOptions()[activeOptionIndex],\n\t\t\t\tactiveOptionIndex,\n\t\t\t});\n\t\t}\n\t};\n\n\thandleNavigateListboxMenu = (event, { direction }) => {\n\t\tconst offsets = { next: 1, previous: -1 };\n\t\t// takes current/previous state and returns an object with the new state\n\t\tthis.setState((prevState) => {\n\t\t\tconst newIndex = this.getNewActiveOptionIndex({\n\t\t\t\tactiveOptionIndex: prevState.activeOptionIndex,\n\t\t\t\toffset: offsets[direction],\n\t\t\t\toptions: this.getOptions(),\n\t\t\t});\n\n\t\t\t// eslint-disable-next-line react/no-access-state-in-setstate\n\t\t\tif (this.getIsOpen()) {\n\t\t\t\tmenuItemSelectScroll({\n\t\t\t\t\tcontainer: this.menuRef,\n\t\t\t\t\tfocusedIndex: newIndex,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tactiveOption: this.getOptions()[newIndex],\n\t\t\t\tactiveOptionIndex: newIndex,\n\t\t\t};\n\t\t});\n\t};\n\n\thandleNavigateSelectedListbox = (event, { direction }) => {\n\t\tconst offsets = { next: 1, previous: -1 };\n\t\tthis.setState((prevState) => {\n\t\t\tconst isLastOptionAndRightIsPressed =\n\t\t\t\tprevState.activeSelectedOptionIndex + 1 ===\n\t\t\t\t\tthis.props.selection.length && direction === 'next';\n\t\t\tconst isFirstOptionAndLeftIsPressed =\n\t\t\t\tprevState.activeSelectedOptionIndex === 0 && direction === 'previous';\n\t\t\tlet newState;\n\n\t\t\tif (isLastOptionAndRightIsPressed) {\n\t\t\t\tnewState = {\n\t\t\t\t\tactiveSelectedOption: this.props.selection[0],\n\t\t\t\t\tactiveSelectedOptionIndex: 0,\n\t\t\t\t\tlistboxHasFocus: true,\n\t\t\t\t};\n\t\t\t} else if (isFirstOptionAndLeftIsPressed) {\n\t\t\t\tnewState = {\n\t\t\t\t\tactiveSelectedOption: this.props.selection[\n\t\t\t\t\t\tthis.props.selection.length - 1\n\t\t\t\t\t],\n\t\t\t\t\tactiveSelectedOptionIndex: this.props.selection.length - 1,\n\t\t\t\t\tlistboxHasFocus: true,\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tconst newIndex = this.getNewActiveOptionIndex({\n\t\t\t\t\tactiveOptionIndex: prevState.activeSelectedOptionIndex,\n\t\t\t\t\toffset: offsets[direction],\n\t\t\t\t\toptions: this.props.selection,\n\t\t\t\t});\n\t\t\t\tnewState = {\n\t\t\t\t\tactiveSelectedOption: this.props.selection[newIndex],\n\t\t\t\t\tactiveSelectedOptionIndex: newIndex,\n\t\t\t\t\tlistboxHasFocus: true,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn newState;\n\t\t});\n\t};\n\n\thandleOpen = (event, data) => {\n\t\tconst isOpen = this.getIsOpen();\n\n\t\tif (!isOpen) {\n\t\t\tif (currentOpenDropdown && isFunction(currentOpenDropdown.handleClose)) {\n\t\t\t\tcurrentOpenDropdown.handleClose();\n\t\t\t}\n\t\t} else {\n\t\t\tcurrentOpenDropdown = this;\n\n\t\t\tthis.setState({\n\t\t\t\tisOpen: true,\n\t\t\t});\n\n\t\t\tif (this.props.events.onOpen) {\n\t\t\t\tthis.props.events.onOpen(event, data);\n\t\t\t}\n\n\t\t\tif (this.props.variant === 'readonly' && this.menuRef !== null) {\n\t\t\t\tconst activeOptionIndex = findIndex(this.getOptions(), (item) =>\n\t\t\t\t\tisEqual(item, this.props.selection[0])\n\t\t\t\t);\n\n\t\t\t\tthis.setState({\n\t\t\t\t\tactiveOptionIndex,\n\t\t\t\t});\n\n\t\t\t\tmenuItemSelectScroll({\n\t\t\t\t\tcontainer: this.menuRef,\n\t\t\t\t\tfocusedIndex: activeOptionIndex,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\n\thandlePillFocus = (event, { option, index }) => {\n\t\tif (!this.state.listboxHasFocus) {\n\t\t\tthis.setState({\n\t\t\t\tactiveSelectedOption: option,\n\t\t\t\tactiveSelectedOptionIndex: index,\n\t\t\t\tlistboxHasFocus: true,\n\t\t\t});\n\t\t}\n\t};\n\n\t/**\n\t * Selected options with selected listbox event methods\n\t */\n\n\thandleRemoveSelectedOption = (event, { option, index }) => {\n\t\tevent.preventDefault();\n\t\tconst onlyOnePillAndInputExists = this.props.selection.length === 1;\n\t\tconst isReadOnlyAndTwoPillsExists =\n\t\t\tthis.props.selection.length === 2 &&\n\t\t\tthis.props.variant === 'readonly' &&\n\t\t\tthis.props.multiple;\n\t\tconst lastPillWasRemoved = index + 1 === this.props.selection.length;\n\n\t\tif (\n\t\t\t(onlyOnePillAndInputExists || isReadOnlyAndTwoPillsExists) &&\n\t\t\tthis.inputRef\n\t\t) {\n\t\t\tthis.inputRef.focus();\n\t\t} else if (lastPillWasRemoved) {\n\t\t\t// set focus to previous option and index\n\t\t\tthis.setState({\n\t\t\t\tactiveSelectedOption: this.props.selection[index - 1],\n\t\t\t\tactiveSelectedOptionIndex: index - 1,\n\t\t\t\tlistboxHasFocus: true,\n\t\t\t});\n\t\t} else {\n\t\t\t// set focus to next option, but same index\n\t\t\tthis.setState({\n\t\t\t\tactiveSelectedOption: this.props.selection[index + 1],\n\t\t\t\tactiveSelectedOptionIndex: index,\n\t\t\t\tlistboxHasFocus: true,\n\t\t\t});\n\t\t}\n\n\t\tif (this.props.events.onRequestRemoveSelectedOption) {\n\t\t\tthis.props.events.onRequestRemoveSelectedOption(event, {\n\t\t\t\tselection: reject(this.props.selection, option),\n\t\t\t});\n\t\t}\n\t};\n\n\thandleRequestClose = (event, data) => {\n\t\tif (this.props.events.onRequestClose) {\n\t\t\tthis.props.events.onRequestClose(event, data);\n\t\t}\n\t\tif (this.getIsOpen()) {\n\t\t\tthis.handleClose(event, { trigger: 'cancel' });\n\t\t}\n\t};\n\n\thandleRequestFocusSelectedListbox = (event, { ref }) => {\n\t\tif (ref) {\n\t\t\tthis.activeSelectedOptionRef = ref;\n\t\t\tthis.activeSelectedOptionRef.focus();\n\t\t}\n\t};\n\n\thandleSelect = (event, { selection, option }) => {\n\t\tlet newSelection;\n\t\tconst isSelected = this.isSelected({ selection, option });\n\t\tconst singleSelectAndSelectedWasNotClicked =\n\t\t\t!this.props.multiple && !isSelected;\n\t\tconst multiSelectAndSelectedWasNotClicked =\n\t\t\tthis.props.multiple && !isSelected;\n\n\t\tif (singleSelectAndSelectedWasNotClicked) {\n\t\t\tnewSelection = [option];\n\t\t} else if (multiSelectAndSelectedWasNotClicked) {\n\t\t\tnewSelection = [...this.props.selection, option];\n\t\t} else {\n\t\t\tnewSelection = reject(this.props.selection, option);\n\t\t}\n\n\t\tif (this.props.events.onSelect) {\n\t\t\tthis.props.events.onSelect(event, { selection: newSelection });\n\t\t}\n\n\t\tthis.handleClose();\n\n\t\t// if (this.inputRef) {\n\t\t// \tthis.inputRef.focus();\n\t\t// }\n\t};\n\n\tisSelected = ({ selection, option }) => !!find(selection, option);\n\n\topenDialog = () => {\n\t\tif (this.props.events.onRequestOpen) {\n\t\t\tthis.props.events.onRequestOpen();\n\t\t} else {\n\t\t\tthis.setState({\n\t\t\t\tisOpen: true,\n\t\t\t});\n\t\t}\n\t};\n\n\trequestOpenMenu = () => {\n\t\tconst isInlineSingleSelectionAndIsNotSelected =\n\t\t\t!this.props.multiple &&\n\t\t\tthis.props.selection.length === 0 &&\n\t\t\tthis.props.variant === 'inline-listbox';\n\n\t\tif (\n\t\t\tisInlineSingleSelectionAndIsNotSelected ||\n\t\t\tthis.props.multiple ||\n\t\t\tthis.props.variant === 'readonly'\n\t\t) {\n\t\t\tthis.openDialog();\n\t\t}\n\t};\n\n\t/**\n\t * Combobox variant subrenders\n\t * (these can probably be broken into function components\n\t * if state is passed in as a prop)\n\t */\n\n\trenderBase = ({ assistiveText, labels, props, userDefinedProps }) => (\n\t\t<div className=\"slds-form-element__control\">\n\t\t\t<div className=\"slds-combobox_container\">\n\t\t\t\t<div\n\t\t\t\t\tclassName={classNames(\n\t\t\t\t\t\t'slds-combobox',\n\t\t\t\t\t\t'slds-dropdown-trigger',\n\t\t\t\t\t\t'slds-dropdown-trigger_click',\n\t\t\t\t\t\t'ignore-react-onclickoutside',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t'slds-is-open': this.getIsOpen(),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t'slds-has-error': props.errorText,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tprops.className\n\t\t\t\t\t)}\n\t\t\t\t\t// Not in ARIA 1.2 spec, temporary for SLDS styles\n\t\t\t\t\trole=\"combobox\" // eslint-disable-line jsx-a11y/role-supports-aria-props, jsx-a11y/role-has-required-aria-props\n\t\t\t\t>\n\t\t\t\t\t<InnerInput\n\t\t\t\t\t\taria-autocomplete=\"list\"\n\t\t\t\t\t\taria-controls={\n\t\t\t\t\t\t\tthis.getIsOpen() ? `${this.getId()}-listbox` : undefined\n\t\t\t\t\t\t}\n\t\t\t\t\t\taria-activedescendant={\n\t\t\t\t\t\t\tthis.state.activeOption\n\t\t\t\t\t\t\t\t? `${this.getId()}-listbox-option-${this.state.activeOption.id}`\n\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t}\n\t\t\t\t\t\taria-describedby={this.getErrorId()}\n\t\t\t\t\t\taria-expanded={this.getIsOpen()}\n\t\t\t\t\t\taria-haspopup=\"listbox\"\n\t\t\t\t\t\trole=\"combobox\"\n\t\t\t\t\t\tautoComplete=\"off\"\n\t\t\t\t\t\tclassName=\"slds-combobox__input\"\n\t\t\t\t\t\tcontainerProps={{\n\t\t\t\t\t\t\tclassName: 'slds-combobox__form-element',\n\t\t\t\t\t\t\trole: 'none',\n\t\t\t\t\t\t}}\n\t\t\t\t\t\thasSpinner={this.props.hasInputSpinner}\n\t\t\t\t\t\ticonRight={\n\t\t\t\t\t\t\t<InputIcon\n\t\t\t\t\t\t\t\tcategory=\"utility\"\n\t\t\t\t\t\t\t\tname=\"search\"\n\t\t\t\t\t\t\t\ttitle={labels.inputIconTitle}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tid={this.getId()}\n\t\t\t\t\t\tonFocus={this.handleInputFocus}\n\t\t\t\t\t\tonBlur={this.handleInputBlur}\n\t\t\t\t\t\tonKeyDown={this.handleKeyDown}\n\t\t\t\t\t\tinputRef={this.setInputRef}\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tthis.openDialog();\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonChange={this.handleInputChange}\n\t\t\t\t\t\tplaceholder={labels.placeholder}\n\t\t\t\t\t\tdefaultValue={props.defaultValue}\n\t\t\t\t\t\treadOnly={\n\t\t\t\t\t\t\t!!(props.predefinedOptionsOnly && this.state.activeOption)\n\t\t\t\t\t\t}\n\t\t\t\t\t\trequired={props.required}\n\t\t\t\t\t\tvalue={\n\t\t\t\t\t\t\tprops.predefinedOptionsOnly\n\t\t\t\t\t\t\t\t? (this.state.activeOption && this.state.activeOption.label) ||\n\t\t\t\t\t\t\t\t  props.value\n\t\t\t\t\t\t\t\t: props.value\n\t\t\t\t\t\t}\n\t\t\t\t\t\t{...userDefinedProps.input}\n\t\t\t\t\t/>\n\t\t\t\t\t{this.getDialog({\n\t\t\t\t\t\tmenuRenderer: this.renderMenu({ assistiveText, labels }),\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<SelectedListBox\n\t\t\t\tactiveOption={this.state.activeSelectedOption}\n\t\t\t\tactiveOptionIndex={this.state.activeSelectedOptionIndex}\n\t\t\t\tassistiveText={assistiveText}\n\t\t\t\tevents={{\n\t\t\t\t\tonBlurPill: this.handleBlurPill,\n\t\t\t\t\tonPillFocus: this.handlePillFocus,\n\t\t\t\t\tonRequestFocus: this.handleRequestFocusSelectedListbox,\n\t\t\t\t\tonRequestFocusOnNextPill: this.handleNavigateSelectedListbox,\n\t\t\t\t\tonRequestFocusOnPreviousPill: this.handleNavigateSelectedListbox,\n\t\t\t\t\tonRequestRemove: this.handleRemoveSelectedOption,\n\t\t\t\t}}\n\t\t\t\tid={`${this.getId()}-selected-listbox`}\n\t\t\t\tlabels={labels}\n\t\t\t\tselectedListboxRef={this.setSelectedListboxRef}\n\t\t\t\tselection={props.selection}\n\t\t\t\tlistboxHasFocus={this.state.listboxHasFocus}\n\t\t\t/>\n\t\t\t{props.errorText && (\n\t\t\t\t<div className=\"slds-has-error\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tid={this.getErrorId()}\n\t\t\t\t\t\tclassName=\"slds-form-element__help slds-has-error\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{props.errorText}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</div>\n\t);\n\n\trenderInlineMultiple = ({\n\t\tassistiveText,\n\t\tlabels,\n\t\tprops,\n\t\tuserDefinedProps,\n\t}) => (\n\t\t<div className=\"slds-form-element__control\">\n\t\t\t<div\n\t\t\t\tclassName={classNames('slds-combobox_container', {\n\t\t\t\t\t'slds-has-inline-listbox': props.selection.length,\n\t\t\t\t})}\n\t\t\t>\n\t\t\t\t{props.selection.length ? (\n\t\t\t\t\t<SelectedListBox\n\t\t\t\t\t\tactiveOption={this.state.activeSelectedOption}\n\t\t\t\t\t\tactiveOptionIndex={this.state.activeSelectedOptionIndex}\n\t\t\t\t\t\tassistiveText={assistiveText}\n\t\t\t\t\t\tcontainerRole=\"listbox\"\n\t\t\t\t\t\tcontainerAriaOrientation=\"horizontal\"\n\t\t\t\t\t\tlistboxRole=\"group\"\n\t\t\t\t\t\tlistboxAriaOrientation={null}\n\t\t\t\t\t\tevents={{\n\t\t\t\t\t\t\tonBlurPill: this.handleBlurPill,\n\t\t\t\t\t\t\tonPillFocus: this.handlePillFocus,\n\t\t\t\t\t\t\tonRequestFocus: this.handleRequestFocusSelectedListbox,\n\t\t\t\t\t\t\tonRequestFocusOnNextPill: this.handleNavigateSelectedListbox,\n\t\t\t\t\t\t\tonRequestFocusOnPreviousPill: this.handleNavigateSelectedListbox,\n\t\t\t\t\t\t\tonRequestRemove: this.handleRemoveSelectedOption,\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tid={`${this.getId()}-selected-listbox`}\n\t\t\t\t\t\tlabels={labels}\n\t\t\t\t\t\tselectedListboxRef={this.setSelectedListboxRef}\n\t\t\t\t\t\tselection={props.selection}\n\t\t\t\t\t\tlistboxHasFocus={this.state.listboxHasFocus}\n\t\t\t\t\t/>\n\t\t\t\t) : null}\n\t\t\t\t<div\n\t\t\t\t\tclassName={classNames(\n\t\t\t\t\t\t'slds-combobox',\n\t\t\t\t\t\t'slds-dropdown-trigger',\n\t\t\t\t\t\t'slds-dropdown-trigger_click',\n\t\t\t\t\t\t'ignore-react-onclickoutside',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t'slds-is-open': this.getIsOpen(),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t'slds-has-error': props.errorText,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tprops.className\n\t\t\t\t\t)}\n\t\t\t\t\t// Not in ARIA 1.2 spec, temporary for SLDS styles\n\t\t\t\t\trole=\"combobox\" // eslint-disable-line jsx-a11y/role-supports-aria-props, jsx-a11y/role-has-required-aria-props\n\t\t\t\t>\n\t\t\t\t\t<InnerInput\n\t\t\t\t\t\taria-autocomplete=\"list\"\n\t\t\t\t\t\taria-controls={\n\t\t\t\t\t\t\tthis.getIsOpen() ? `${this.getId()}-listbox` : undefined\n\t\t\t\t\t\t}\n\t\t\t\t\t\taria-activedescendant={\n\t\t\t\t\t\t\tthis.state.activeOption\n\t\t\t\t\t\t\t\t? `${this.getId()}-listbox-option-${this.state.activeOption.id}`\n\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t}\n\t\t\t\t\t\taria-describedby={this.getErrorId()}\n\t\t\t\t\t\taria-expanded={this.getIsOpen()}\n\t\t\t\t\t\taria-haspopup=\"listbox\" // eslint-disable-line jsx-a11y/aria-proptypes\n\t\t\t\t\t\trole=\"combobox\"\n\t\t\t\t\t\tdefaultValue={props.defaultValue}\n\t\t\t\t\t\tautoComplete=\"off\"\n\t\t\t\t\t\tclassName=\"slds-combobox__input\"\n\t\t\t\t\t\tcontainerProps={{\n\t\t\t\t\t\t\tclassName: 'slds-combobox__form-element',\n\t\t\t\t\t\t\trole: 'none',\n\t\t\t\t\t\t}}\n\t\t\t\t\t\thasSpinner={this.props.hasInputSpinner}\n\t\t\t\t\t\ticonRight={\n\t\t\t\t\t\t\t<InputIcon\n\t\t\t\t\t\t\t\tcategory=\"utility\"\n\t\t\t\t\t\t\t\tname=\"search\"\n\t\t\t\t\t\t\t\ttitle={labels.inputIconTitle}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tid={this.getId()}\n\t\t\t\t\t\tonFocus={this.handleInputFocus}\n\t\t\t\t\t\tonBlur={this.handleInputBlur}\n\t\t\t\t\t\tonKeyDown={this.handleKeyDown}\n\t\t\t\t\t\tinputRef={this.setInputRef}\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tthis.openDialog();\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonChange={this.handleInputChange}\n\t\t\t\t\t\tplaceholder={labels.placeholder}\n\t\t\t\t\t\treadOnly={\n\t\t\t\t\t\t\t!!(props.predefinedOptionsOnly && this.state.activeOption)\n\t\t\t\t\t\t}\n\t\t\t\t\t\trequired={props.required}\n\t\t\t\t\t\tvalue={\n\t\t\t\t\t\t\tprops.predefinedOptionsOnly\n\t\t\t\t\t\t\t\t? (this.state.activeOption && this.state.activeOption.label) ||\n\t\t\t\t\t\t\t\t  props.value\n\t\t\t\t\t\t\t\t: props.value\n\t\t\t\t\t\t}\n\t\t\t\t\t\t{...userDefinedProps.input}\n\t\t\t\t\t/>\n\t\t\t\t\t{this.getDialog({\n\t\t\t\t\t\tmenuRenderer: this.renderMenu({ assistiveText, labels }),\n\t\t\t\t\t})}\n\t\t\t\t\t{props.errorText && (\n\t\t\t\t\t\t<div id={this.getErrorId()} className=\"slds-form-element__help\">\n\t\t\t\t\t\t\t{props.errorText}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n\n\trenderInlineSingle = ({ assistiveText, labels, props, userDefinedProps }) => {\n\t\tconst iconLeft =\n\t\t\tprops.selection[0] && props.selection[0].icon\n\t\t\t\t? React.cloneElement(props.selection[0].icon, {\n\t\t\t\t\t\tcontainerClassName: 'slds-combobox__input-entity-icon',\n\t\t\t\t  })\n\t\t\t\t: null;\n\n\t\tconst value =\n\t\t\tprops.selection[0] && props.selection[0].label\n\t\t\t\t? props.selection[0].label\n\t\t\t\t: props.value;\n\n\t\treturn (\n\t\t\t<div className=\"slds-form-element__control\">\n\t\t\t\t<div\n\t\t\t\t\tclassName={classNames('slds-combobox_container', {\n\t\t\t\t\t\t'slds-has-inline-listbox': props.selection.length,\n\t\t\t\t\t})}\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={classNames(\n\t\t\t\t\t\t\t'slds-combobox',\n\t\t\t\t\t\t\t'slds-dropdown-trigger',\n\t\t\t\t\t\t\t'slds-dropdown-trigger_click',\n\t\t\t\t\t\t\t'ignore-react-onclickoutside',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'slds-is-open': this.getIsOpen(),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'slds-has-error': props.errorText,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tprops.className\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t// Not in ARIA 1.2 spec, temporary for SLDS styles\n\t\t\t\t\t\trole=\"combobox\" // eslint-disable-line jsx-a11y/role-supports-aria-props, jsx-a11y/role-has-required-aria-props\n\t\t\t\t\t>\n\t\t\t\t\t\t<InnerInput\n\t\t\t\t\t\t\tdefaultValue={props.defaultValue}\n\t\t\t\t\t\t\taria-autocomplete=\"list\"\n\t\t\t\t\t\t\taria-controls={\n\t\t\t\t\t\t\t\tthis.getIsOpen() ? `${this.getId()}-listbox` : undefined\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\taria-activedescendant={\n\t\t\t\t\t\t\t\tthis.state.activeOption\n\t\t\t\t\t\t\t\t\t? `${this.getId()}-listbox-option-${\n\t\t\t\t\t\t\t\t\t\t\tthis.state.activeOption.id\n\t\t\t\t\t\t\t\t\t  }`\n\t\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\taria-describedby={this.getErrorId()}\n\t\t\t\t\t\t\taria-expanded={this.getIsOpen()}\n\t\t\t\t\t\t\taria-haspopup=\"listbox\" // eslint-disable-line jsx-a11y/aria-proptypes\n\t\t\t\t\t\t\trole=\"combobox\"\n\t\t\t\t\t\t\tautoComplete=\"off\"\n\t\t\t\t\t\t\tclassName=\"slds-combobox__input\"\n\t\t\t\t\t\t\tcontainerProps={{\n\t\t\t\t\t\t\t\tclassName: 'slds-combobox__form-element',\n\t\t\t\t\t\t\t\trole: 'none',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tdisabled={this.props.singleInputDisabled}\n\t\t\t\t\t\t\thasSpinner={this.props.hasInputSpinner}\n\t\t\t\t\t\t\ticonRight={\n\t\t\t\t\t\t\t\tprops.selection.length ? (\n\t\t\t\t\t\t\t\t\t<InputIcon\n\t\t\t\t\t\t\t\t\t\tassistiveText={{\n\t\t\t\t\t\t\t\t\t\t\ticon: assistiveText.removeSingleSelectedOption,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tbuttonRef={(component) => {\n\t\t\t\t\t\t\t\t\t\t\tthis.buttonRef = component;\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tcategory=\"utility\"\n\t\t\t\t\t\t\t\t\t\ticonPosition=\"right\"\n\t\t\t\t\t\t\t\t\t\tname=\"close\"\n\t\t\t\t\t\t\t\t\t\tonClick={(event) => {\n\t\t\t\t\t\t\t\t\t\t\tthis.handleRemoveSelectedOption(event, {\n\t\t\t\t\t\t\t\t\t\t\t\toption: props.selection[0],\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<InputIcon category=\"utility\" name=\"search\" />\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ticonLeft={iconLeft}\n\t\t\t\t\t\t\tid={this.getId()}\n\t\t\t\t\t\t\tonFocus={this.handleInputFocus}\n\t\t\t\t\t\t\tonBlur={this.handleInputBlur}\n\t\t\t\t\t\t\tonKeyDown={this.handleKeyDown}\n\t\t\t\t\t\t\tinputRef={this.setInputRef}\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tthis.requestOpenMenu();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tonChange={(event) => {\n\t\t\t\t\t\t\t\tif (!props.selection.length) {\n\t\t\t\t\t\t\t\t\tthis.handleInputChange(event);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tplaceholder={labels.placeholder}\n\t\t\t\t\t\t\treadOnly={\n\t\t\t\t\t\t\t\t!!(props.predefinedOptionsOnly && this.state.activeOption) ||\n\t\t\t\t\t\t\t\t!!props.selection.length\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trequired={props.required}\n\t\t\t\t\t\t\tvalue={\n\t\t\t\t\t\t\t\tprops.predefinedOptionsOnly\n\t\t\t\t\t\t\t\t\t? (this.state.activeOption &&\n\t\t\t\t\t\t\t\t\t\t\tthis.state.activeOption.label) ||\n\t\t\t\t\t\t\t\t\t  props.value\n\t\t\t\t\t\t\t\t\t: value\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t{...userDefinedProps.input}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{this.getDialog({\n\t\t\t\t\t\t\tmenuRenderer: this.renderMenu({ assistiveText, labels }),\n\t\t\t\t\t\t})}\n\t\t\t\t\t\t{props.errorText && (\n\t\t\t\t\t\t\t<div id={this.getErrorId()} className=\"slds-form-element__help\">\n\t\t\t\t\t\t\t\t{props.errorText}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t};\n\n\trenderMenu = ({ assistiveText, labels }) => {\n\t\tconst menuVariant = {\n\t\t\tbase: 'icon-title-subtitle',\n\t\t\t'inline-listbox': 'icon-title-subtitle',\n\t\t\treadonly: 'checkbox',\n\t\t};\n\n\t\tconst readonlyItemVisibleLength =\n\t\t\tthis.props.variant === 'readonly' ? 5 : null;\n\n\t\treturn (\n\t\t\t<Menu\n\t\t\t\tassistiveText={assistiveText}\n\t\t\t\tactiveOption={this.state.activeOption}\n\t\t\t\tactiveOptionIndex={this.state.activeOptionIndex}\n\t\t\t\tclassNameMenu={this.props.classNameMenu}\n\t\t\t\tclassNameMenuSubHeader={this.props.classNameMenuSubHeader}\n\t\t\t\tclearActiveOption={this.clearActiveOption}\n\t\t\t\tinheritWidthOf={this.props.inheritWidthOf}\n\t\t\t\tinputId={this.getId()}\n\t\t\t\tinputValue={this.props.value}\n\t\t\t\tisSelected={this.isSelected}\n\t\t\t\titemVisibleLength={\n\t\t\t\t\tthis.props.menuItemVisibleLength || readonlyItemVisibleLength\n\t\t\t\t}\n\t\t\t\tlabels={labels}\n\t\t\t\thasMenuSpinner={this.props.hasMenuSpinner}\n\t\t\t\tmenuItem={this.props.menuItem}\n\t\t\t\tmenuPosition={this.props.menuPosition}\n\t\t\t\tmenuRef={(ref) => {\n\t\t\t\t\tthis.menuRef = ref;\n\t\t\t\t}}\n\t\t\t\tmaxWidth={this.props.menuMaxWidth}\n\t\t\t\toptions={this.props.options}\n\t\t\t\toptionsAddItem={this.props.optionsAddItem}\n\t\t\t\toptionsSearchEntity={this.props.optionsSearchEntity}\n\t\t\t\tonSelect={this.handleSelect}\n\t\t\t\t// For backward compatibility, 'menuItem' prop will be deprecated soon\n\t\t\t\tonRenderMenuItem={\n\t\t\t\t\tthis.props.onRenderMenuItem\n\t\t\t\t\t\t? this.props.onRenderMenuItem\n\t\t\t\t\t\t: this.props.menuItem\n\t\t\t\t}\n\t\t\t\tselection={this.props.selection}\n\t\t\t\ttooltipMenuItemDisabled={this.props.tooltipMenuItemDisabled}\n\t\t\t\tvariant={menuVariant[this.props.variant]}\n\t\t\t/>\n\t\t);\n\t};\n\n\trenderPopover = ({ assistiveText, labels, props }) => {\n\t\tconst popoverProps = this.getCustomPopoverProps(\n\t\t\tthis.props.popover.props.body,\n\t\t\t{ assistiveText, labels }\n\t\t);\n\n\t\treturn (\n\t\t\t<div className=\"slds-form-element__control\">\n\t\t\t\t<div className=\"slds-combobox_container\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={classNames(\n\t\t\t\t\t\t\t'slds-combobox',\n\t\t\t\t\t\t\t'slds-dropdown-trigger',\n\t\t\t\t\t\t\t'slds-dropdown-trigger_click',\n\t\t\t\t\t\t\t'ignore-react-onclickoutside',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'slds-is-open': this.getIsOpen(),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'slds-has-error': props.errorText,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tprops.className\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t// Not in ARIA 1.2 spec, temporary for SLDS styles\n\t\t\t\t\t\trole=\"combobox\" // eslint-disable-line jsx-a11y/role-supports-aria-props, jsx-a11y/role-has-required-aria-props\n\t\t\t\t\t>\n\t\t\t\t\t\t<Popover {...popoverProps}>\n\t\t\t\t\t\t\t<InnerInput\n\t\t\t\t\t\t\t\taria-autocomplete=\"none\"\n\t\t\t\t\t\t\t\taria-controls={\n\t\t\t\t\t\t\t\t\tthis.getIsOpen() ? `${this.getId()}-popover` : undefined\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\taria-describedby={this.getErrorId()}\n\t\t\t\t\t\t\t\taria-expanded={this.getIsOpen()}\n\t\t\t\t\t\t\t\taria-haspopup=\"dialog\" // eslint-disable-line jsx-a11y/aria-proptypes\n\t\t\t\t\t\t\t\trole=\"combobox\"\n\t\t\t\t\t\t\t\tautoComplete=\"off\"\n\t\t\t\t\t\t\t\tclassName=\"slds-combobox__input\"\n\t\t\t\t\t\t\t\tcontainerProps={{\n\t\t\t\t\t\t\t\t\tclassName: 'slds-combobox__form-element',\n\t\t\t\t\t\t\t\t\trole: 'none',\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\ticonRight={\n\t\t\t\t\t\t\t\t\t<InputIcon\n\t\t\t\t\t\t\t\t\t\tcategory=\"utility\"\n\t\t\t\t\t\t\t\t\t\tname=\"down\"\n\t\t\t\t\t\t\t\t\t\tvariant=\"combobox\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tid={this.getId()}\n\t\t\t\t\t\t\t\tonFocus={this.handleInputFocus}\n\t\t\t\t\t\t\t\tonBlur={this.handleInputBlur}\n\t\t\t\t\t\t\t\tonKeyDown={this.handleKeyDown}\n\t\t\t\t\t\t\t\tinputRef={this.setInputRef}\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tthis.openDialog();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tonChange={this.handleInputChange}\n\t\t\t\t\t\t\t\tplaceholder={labels.placeholder}\n\t\t\t\t\t\t\t\treadOnly\n\t\t\t\t\t\t\t\trequired={props.required}\n\t\t\t\t\t\t\t\tvalue={props.value}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Popover>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{props.errorText && (\n\t\t\t\t\t<div className=\"slds-has-error\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tid={this.getErrorId()}\n\t\t\t\t\t\t\tclassName=\"slds-form-element__help slds-has-error\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{props.errorText}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t);\n\t};\n\n\trenderReadOnlyMultiple = ({\n\t\tassistiveText,\n\t\tlabels,\n\t\tprops,\n\t\tuserDefinedProps,\n\t}) => {\n\t\tconst value =\n\t\t\tprops.selection.length > 1\n\t\t\t\t? labels.multipleOptionsSelected ||\n\t\t\t\t  `${props.selection.length} options selected`\n\t\t\t\t: (props.selection[0] && props.selection[0].label) || '';\n\n\t\treturn (\n\t\t\t<div className=\"slds-form-element__control\">\n\t\t\t\t<div className=\"slds-combobox_container\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={classNames(\n\t\t\t\t\t\t\t'slds-combobox',\n\t\t\t\t\t\t\t'slds-dropdown-trigger',\n\t\t\t\t\t\t\t'slds-dropdown-trigger_click',\n\t\t\t\t\t\t\t'ignore-react-onclickoutside',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'slds-is-open': this.getIsOpen(),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'slds-has-error': props.errorText,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tprops.className\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t// Not in ARIA 1.2 spec, temporary for SLDS styles\n\t\t\t\t\t\trole=\"combobox\" // eslint-disable-line jsx-a11y/role-supports-aria-props, jsx-a11y/role-has-required-aria-props\n\t\t\t\t\t>\n\t\t\t\t\t\t<InnerInput\n\t\t\t\t\t\t\tdefaultValue={props.defaultValue}\n\t\t\t\t\t\t\taria-autocomplete=\"list\"\n\t\t\t\t\t\t\taria-controls={\n\t\t\t\t\t\t\t\tthis.getIsOpen() ? `${this.getId()}-listbox` : undefined\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\taria-activedescendant={\n\t\t\t\t\t\t\t\tthis.state.activeOption\n\t\t\t\t\t\t\t\t\t? `${this.getId()}-listbox-option-${\n\t\t\t\t\t\t\t\t\t\t\tthis.state.activeOption.id\n\t\t\t\t\t\t\t\t\t  }`\n\t\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\taria-describedby={this.getErrorId()}\n\t\t\t\t\t\t\taria-expanded={this.getIsOpen()}\n\t\t\t\t\t\t\taria-haspopup=\"listbox\" // eslint-disable-line jsx-a11y/aria-proptypes\n\t\t\t\t\t\t\trole=\"combobox\"\n\t\t\t\t\t\t\tautoComplete=\"off\"\n\t\t\t\t\t\t\tclassName=\"slds-combobox__input\"\n\t\t\t\t\t\t\tcontainerProps={{\n\t\t\t\t\t\t\t\tclassName: 'slds-combobox__form-element',\n\t\t\t\t\t\t\t\trole: 'none',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ticonRight={\n\t\t\t\t\t\t\t\t<InputIcon category=\"utility\" name=\"down\" variant=\"combobox\" />\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tid={this.getId()}\n\t\t\t\t\t\t\tonFocus={this.handleInputFocus}\n\t\t\t\t\t\t\tonBlur={this.handleInputBlur}\n\t\t\t\t\t\t\tonKeyDown={this.handleKeyDown}\n\t\t\t\t\t\t\tinputRef={this.setInputRef}\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tthis.requestOpenMenu();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tonChange={(event) => {\n\t\t\t\t\t\t\t\tif (!props.selection.length) {\n\t\t\t\t\t\t\t\t\tthis.handleInputChange(event);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tplaceholder={labels.placeholderReadOnly}\n\t\t\t\t\t\t\treadOnly\n\t\t\t\t\t\t\trequired={props.required}\n\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t\t{...userDefinedProps.input}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{this.getDialog({\n\t\t\t\t\t\t\tmenuRenderer: this.renderMenu({ assistiveText, labels }),\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<SelectedListBox\n\t\t\t\t\tactiveOption={this.state.activeSelectedOption}\n\t\t\t\t\tactiveOptionIndex={this.state.activeSelectedOptionIndex}\n\t\t\t\t\tassistiveText={assistiveText}\n\t\t\t\t\tevents={{\n\t\t\t\t\t\tonBlurPill: this.handleBlurPill,\n\t\t\t\t\t\tonPillFocus: this.handlePillFocus,\n\t\t\t\t\t\tonRequestFocus: this.handleRequestFocusSelectedListbox,\n\t\t\t\t\t\tonRequestFocusOnNextPill: this.handleNavigateSelectedListbox,\n\t\t\t\t\t\tonRequestFocusOnPreviousPill: this.handleNavigateSelectedListbox,\n\t\t\t\t\t\tonRequestRemove: this.handleRemoveSelectedOption,\n\t\t\t\t\t}}\n\t\t\t\t\tid={`${this.getId()}-selected-listbox`}\n\t\t\t\t\tlabels={labels}\n\t\t\t\t\tselectedListboxRef={this.setSelectedListboxRef}\n\t\t\t\t\tselection={props.selection}\n\t\t\t\t\tlistboxHasFocus={this.state.listboxHasFocus}\n\t\t\t\t\tvariant={this.props.variant}\n\t\t\t\t\trenderAtSelectionLength={2}\n\t\t\t\t/>\n\t\t\t\t{props.errorText && (\n\t\t\t\t\t<div className=\"slds-has-error\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tid={this.getErrorId()}\n\t\t\t\t\t\t\tclassName=\"slds-form-element__help slds-has-error\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{props.errorText}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t);\n\t};\n\n\trenderReadOnlySingle = ({\n\t\tassistiveText,\n\t\tlabels,\n\t\tprops,\n\t\tuserDefinedProps,\n\t}) => {\n\t\tconst value = (props.selection[0] && props.selection[0].label) || '';\n\n\t\treturn (\n\t\t\t<div className=\"slds-form-element__control\">\n\t\t\t\t<div className=\"slds-combobox_container\">\n\t\t\t\t\t<div // aria attributes have been moved to the `div` wrapping `input` to comply with ARIA 1.1.\n\t\t\t\t\t\tclassName={classNames(\n\t\t\t\t\t\t\t'slds-combobox',\n\t\t\t\t\t\t\t'slds-dropdown-trigger',\n\t\t\t\t\t\t\t'slds-dropdown-trigger_click',\n\t\t\t\t\t\t\t'ignore-react-onclickoutside',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'slds-is-open': this.getIsOpen(),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'slds-has-error': props.errorText,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tprops.className\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t// Not in ARIA 1.2 spec, temporary for SLDS styles\n\t\t\t\t\t\trole=\"combobox\" // eslint-disable-line jsx-a11y/role-supports-aria-props, jsx-a11y/role-has-required-aria-props\n\t\t\t\t\t>\n\t\t\t\t\t\t<InnerInput\n\t\t\t\t\t\t\tdefaultValue={props.defaultValue}\n\t\t\t\t\t\t\taria-autocomplete=\"list\"\n\t\t\t\t\t\t\taria-controls={\n\t\t\t\t\t\t\t\tthis.getIsOpen() ? `${this.getId()}-listbox` : undefined\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\taria-activedescendant={\n\t\t\t\t\t\t\t\tthis.state.activeOption\n\t\t\t\t\t\t\t\t\t? `${this.getId()}-listbox-option-${\n\t\t\t\t\t\t\t\t\t\t\tthis.state.activeOption.id\n\t\t\t\t\t\t\t\t\t  }`\n\t\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\taria-describedby={this.getErrorId()}\n\t\t\t\t\t\t\taria-expanded={this.getIsOpen()}\n\t\t\t\t\t\t\taria-haspopup=\"listbox\" // eslint-disable-line jsx-a11y/aria-proptypes\n\t\t\t\t\t\t\trole=\"combobox\"\n\t\t\t\t\t\t\tautoComplete=\"off\"\n\t\t\t\t\t\t\tclassName=\"slds-combobox__input\"\n\t\t\t\t\t\t\tcontainerProps={{\n\t\t\t\t\t\t\t\tclassName: 'slds-combobox__form-element',\n\t\t\t\t\t\t\t\trole: 'none',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tdisabled={this.props.singleInputDisabled}\n\t\t\t\t\t\t\ticonRight={\n\t\t\t\t\t\t\t\t<InputIcon category=\"utility\" name=\"down\" variant=\"combobox\" />\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tid={this.getId()}\n\t\t\t\t\t\t\tonFocus={this.handleInputFocus}\n\t\t\t\t\t\t\tonBlur={this.handleInputBlur}\n\t\t\t\t\t\t\tonKeyDown={this.handleKeyDown}\n\t\t\t\t\t\t\tinputRef={this.setInputRef}\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tthis.requestOpenMenu();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tonChange={(event) => {\n\t\t\t\t\t\t\t\tif (!props.selection.length) {\n\t\t\t\t\t\t\t\t\tthis.handleInputChange(event);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tplaceholder={labels.placeholderReadOnly}\n\t\t\t\t\t\t\treadOnly\n\t\t\t\t\t\t\trequired={props.required}\n\t\t\t\t\t\t\tvalue={\n\t\t\t\t\t\t\t\t(this.state.activeOption && this.state.activeOption.label) ||\n\t\t\t\t\t\t\t\tvalue\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t{...userDefinedProps.input}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{this.getDialog({\n\t\t\t\t\t\t\tmenuRenderer: this.renderMenu({ assistiveText, labels }),\n\t\t\t\t\t\t})}\n\t\t\t\t\t\t{props.errorText && (\n\t\t\t\t\t\t\t<div id={this.getErrorId()} className=\"slds-form-element__help\">\n\t\t\t\t\t\t\t\t{props.errorText}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t};\n\n\trender() {\n\t\tconst { props } = this;\n\t\t// Merge objects of strings with their default object\n\t\tconst assistiveText = assign(\n\t\t\t{},\n\t\t\tdefaultProps.assistiveText,\n\t\t\tprops.assistiveText\n\t\t);\n\t\tconst labels = assign({}, defaultProps.labels, this.props.labels);\n\t\tconst hasRenderedLabel =\n\t\t\tlabels.label || (assistiveText && assistiveText.label);\n\t\t// declare user defined props\n\t\tconst userDefinedProps = {};\n\t\tif (props.input) {\n\t\t\t// at the moment we only support overriding the input props\n\t\t\tuserDefinedProps.input = props.input.props;\n\t\t}\n\t\tconst subRenderParameters = {\n\t\t\tassistiveText,\n\t\t\tlabels,\n\t\t\tprops: this.props,\n\t\t\tuserDefinedProps,\n\t\t};\n\t\tconst multipleOrSingle = this.props.multiple ? 'multiple' : 'single';\n\t\tconst subRenders = {\n\t\t\tbase: {\n\t\t\t\tmultiple: this.renderBase, // same\n\t\t\t\tsingle: this.renderBase,\n\t\t\t},\n\t\t\t'inline-listbox': {\n\t\t\t\tmultiple: this.renderInlineMultiple,\n\t\t\t\tsingle: this.renderInlineSingle,\n\t\t\t},\n\t\t\tpopover: {\n\t\t\t\tmultiple: this.renderPopover, // same\n\t\t\t\tsingle: this.renderPopover,\n\t\t\t},\n\t\t\treadonly: {\n\t\t\t\tmultiple: this.renderReadOnlyMultiple,\n\t\t\t\tsingle: this.renderReadOnlySingle,\n\t\t\t},\n\t\t};\n\t\tconst variantExists = subRenders[this.props.variant][multipleOrSingle];\n\n\t\tconst mainCombobox = (\n\t\t\t<div\n\t\t\t\tclassName={classNames('slds-form-element', props.classNameContainer)}\n\t\t\t>\n\t\t\t\t{props.entityCombobox ? null : (\n\t\t\t\t\t<Label\n\t\t\t\t\t\tassistiveText={this.props.assistiveText}\n\t\t\t\t\t\thtmlFor={this.getId()}\n\t\t\t\t\t\tlabel={labels.label}\n\t\t\t\t\t\trequired={props.required}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t{this.props.fieldLevelHelpTooltip && hasRenderedLabel ? (\n\t\t\t\t\t<FieldLevelHelpTooltip\n\t\t\t\t\t\tfieldLevelHelpTooltip={this.props.fieldLevelHelpTooltip}\n\t\t\t\t\t/>\n\t\t\t\t) : null}\n\t\t\t\t{variantExists\n\t\t\t\t\t? subRenders[this.props.variant][multipleOrSingle](\n\t\t\t\t\t\t\tsubRenderParameters\n\t\t\t\t\t  )\n\t\t\t\t\t: subRenders.base.multiple(subRenderParameters)}\n\t\t\t</div>\n\t\t);\n\n\t\treturn props.entityCombobox ? (\n\t\t\t<div className=\"slds-form-element\">\n\t\t\t\t<Label\n\t\t\t\t\tassistiveText={props.assistiveText}\n\t\t\t\t\thtmlFor={this.getId()}\n\t\t\t\t\tlabel={labels.label}\n\t\t\t\t\trequired={props.required}\n\t\t\t\t/>\n\t\t\t\t<div className=\"slds-form-element__control\">\n\t\t\t\t\t<div className=\"slds-combobox-group\">\n\t\t\t\t\t\t<div className=\"slds-combobox_object-switcher slds-combobox-addon_start\">\n\t\t\t\t\t\t\t{props.entityCombobox}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className=\"slds-combobox_container slds-combobox-addon_end\">\n\t\t\t\t\t\t\t{mainCombobox}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t) : (\n\t\t\tmainCombobox\n\t\t);\n\t}\n}\n\nCombobox.contextType = IconSettingsContext;\nCombobox.displayName = COMBOBOX;\nCombobox.propTypes = propTypes;\nCombobox.defaultProps = defaultProps;\n\nexport default Combobox;\n"],"file":"combobox.js"}